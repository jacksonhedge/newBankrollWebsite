import{i as U,u as C,r as l,j as t,J as b}from"./index-DlkRxCvT-1733463450864.js";import{g as j}from"./GroupService-s2AM5D8L-1733463450864.js";const L=()=>{const v=U(),{currentUser:c}=C(),[d,y]=l.useState(""),[i,u]=l.useState(""),[h,n]=l.useState([]),[o,p]=l.useState([]),[x,g]=l.useState(!1),[N,m]=l.useState("");l.useEffect(()=>{const e=setTimeout(async()=>{if(i.length>=2)try{const r=(await j.searchUsers(i)).filter(a=>a.uid!==c.uid&&!o.some(R=>R.uid===a.uid));n(r)}catch(s){console.error("Error searching users:",s),m("Failed to search users")}else n([])},300);return()=>clearTimeout(e)},[i,c.uid,o]);const f=async e=>{e.preventDefault(),g(!0),m("");try{const s={name:d,pendingMembers:o.map(a=>({uid:a.uid,displayName:a.displayName,username:a.username,phone:a.phone,photoURL:a.photoURL}))},r=await j.createGroup(s,c);v(`/group/${r.id}`)}catch(s){console.error("Error creating group:",s),m("Failed to create group")}finally{g(!1)}},w=e=>{p(s=>[...s,e]),n(s=>s.filter(r=>r.uid!==e.uid)),u("")},S=e=>{p(s=>s.filter(r=>r.uid!==e.uid))};return t.jsxs("div",{className:"container mx-auto px-4 py-8",children:[t.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Create a New Group"}),t.jsxs("form",{onSubmit:f,className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"groupName",className:"block text-sm font-medium text-white mb-2",children:"Enter Group Name"}),t.jsx(b,{id:"groupName",type:"text",value:d,onChange:e=>y(e.target.value),placeholder:"Enter group name",required:!0,className:"bg-gray-900/40 text-white placeholder-gray-400"})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"userSearch",className:"block text-sm font-medium text-white mb-2",children:"Add Members"}),t.jsx(b,{id:"userSearch",type:"text",value:i,onChange:e=>u(e.target.value),placeholder:"Search by username or phone",className:"bg-gray-900/40 text-white placeholder-gray-400"}),h.length>0&&t.jsx("div",{className:"mt-2 border border-purple-500/20 rounded-md overflow-hidden",children:h.map((e,s)=>t.jsxs("div",{className:"p-3 hover:bg-gray-900/40 cursor-pointer flex items-center justify-between",onClick:()=>w(e),children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[e.photoURL&&t.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-8 h-8 rounded-full"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-white",children:e.displayName}),t.jsx("div",{className:"text-sm text-gray-400",children:e.username||e.phone})]})]}),t.jsx("button",{type:"button",className:"text-purple-500 hover:text-purple-400",children:"Add"})]},`search-${e.uid}-${s}`))}),o.length>0&&t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"text-sm font-medium text-white mb-2",children:"Selected Members"}),t.jsx("div",{className:"space-y-2",children:o.map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-900/40 rounded-md",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[e.photoURL&&t.jsx("img",{src:e.photoURL,alt:e.displayName,className:"w-8 h-8 rounded-full"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-white",children:e.displayName}),t.jsx("div",{className:"text-sm text-gray-400",children:e.username||e.phone})]})]}),t.jsx("button",{type:"button",onClick:()=>S(e),className:"text-red-500 hover:text-red-400",children:"Remove"})]},`selected-${e.uid}-${s}`))})]})]}),N&&t.jsx("div",{className:"text-red-500 text-sm",children:N}),t.jsx("button",{type:"submit",disabled:x||!d.trim(),className:"w-full bg-purple-500 text-white py-2 px-4 rounded-md hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Creating...":"Create Group"})]})]})};export{L as default};
